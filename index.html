<!doctype html>
<html lang="en">
    <head>
        <!-- Tournament website - auto rebuild trigger -->
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Buggy Lapping Tournament</title>

        <style>
            * {
                box-sizing: border-box;
            }
            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: #333;
                margin: 0;
                padding: 20px;
                background: #ffffff;
            }
            .container {
                max-width: 1000px;
                margin: 0 auto;
            }
            .header {
                text-align: center;
                margin-bottom: 40px;
                padding: 30px;
                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                border-radius: 12px;
                border: 1px solid #dee2e6;
            }
            .header h1 {
                margin: 0 0 10px 0;
                font-size: 2.5em;
                color: #2c3e50;
                font-weight: 700;
            }
            .header p {
                margin: 0;
                font-size: 1.1em;
                color: #6c757d;
            }
            .section {
                margin-bottom: 40px;
                padding: 25px;
                background: #fff;
                border-radius: 10px;
                border: 1px solid #dee2e6;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .section h2 {
                margin: 0 0 20px 0;
                font-size: 1.8em;
                color: #2c3e50;
                border-bottom: 2px solid #3498db;
                padding-bottom: 10px;
            }
            .rules-text {
                background: #f8f9fa;
                padding: 12px;
                border-radius: 8px;
                white-space: pre-line;
                border-left: 4px solid #3498db;
                font-size: 0.95em;
                line-height: 1.4;
            }
            .rules-section {
                padding: 15px !important;
            }
            .rules-section h2 {
                margin-bottom: 10px !important;
                font-size: 1.6em !important;
            }
            .section h2 {
                font-size: 1.6em !important;
            }
            table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
                background: #fff;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            th,
            td {
                padding: 12px 15px;
                text-align: left;
                border-bottom: 1px solid #dee2e6;
            }
            th {
                background: #3498db;
                color: white;
                font-weight: 600;
                text-transform: uppercase;
                font-size: 0.9em;
                letter-spacing: 0.5px;
            }
            tr:nth-child(even) {
                background: #f8f9fa;
            }
            tr:hover {
                background: #e3f2fd;
            }
            .standings-table th:first-child,
            .standings-table td:first-child {
                text-align: center;
                font-weight: bold;
                color: #2c3e50;
            }
            .standings-table .total-points {
                font-weight: bold;
                color: #27ae60;
                font-size: 1.1em;
            }
            .leader-row {
                background: #d5edda !important;
                border-left: 4px solid #27ae60;
            }
            .leader-row:hover {
                background: #c3e6cb !important;
            }
            .position-1 {
                color: #f39c12;
                font-weight: bold;
            }
            .position-2 {
                color: #95a5a6;Results
                font-weight: bold;
            }
            .position-3 {
                color: #e67e22;
                font-weight: bold;
            }
            .points-system {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 8px;
                margin: 15px 0;
            }
            .points-badge {
                background: #3498db;
                color: white;
                padding: 6px 10px;
                border-radius: 16px;
                text-align: center;
                font-weight: 600;
                font-size: 0.85em;
            }
            .points-badge.gold {
                background: #f39c12;
            }
            .points-badge.silver {
                background: #95a5a6;
            }
            .points-badge.bronze {
                background: #e67e22;
            }
            .zones-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 15px;
                margin-top: 20px;
            }
            .zone-card {
                background: #f8f9fa;
                border: 1px solid #dee2e6;
                border-radius: 8px;
                padding: 15px;
                text-align: center;
            }
            .zone-card h3 {
                margin: 0 0 5px 0;
                color: #2c3e50;
            }
            .zone-card p {
                margin: 0;
                color: #6c757d;
                font-style: italic;
            }
            .footer {
                margin-top: 40px;
                padding: 20px;
                text-align: center;
                background: #f8f9fa;
                border-radius: 8px;
                border: 1px solid #dee2e6;
            }
            .footer p {
                margin: 0;
                font-size: 0.9em;
                color: #6c757d;
            }
            .zone-table {
                margin-bottom: 30px;
            }
            .zone-table h3 {
                margin: 0 0 15px 0;
                color: #2c3e50;
                font-size: 1.3em;
            }
            .tab-navigation {
                display: flex;
                border-bottom: 2px solid #3498db;
                margin-bottom: 0;
            }
            .tab-button {
                background: none;
                border: none;
                padding: 12px 20px;
                cursor: pointer;
                font-size: 1em;
                color: #6c757d;
                border-bottom: 2px solid transparent;
                transition: all 0.3s ease;
            }
            .tab-button:hover {
                color: #3498db;
                background: rgba(52, 152, 219, 0.1);
            }
            .tab-button.active {
                color: #3498db;
                border-bottom-color: #3498db;
                background: rgba(52, 152, 219, 0.1);
            }
            .tab-content {
                display: none;
            }
            .tab-content.active {
                display: block;
            }
            .tab-section {
                padding: 15px !important;
            }
            .tab-section h2 {
                margin-bottom: 10px !important;
                font-size: 1.6em !important;
            }
            .tournament-info {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                margin: 20px 0;
                border-left: 4px solid #3498db;
            }
            .tournament-info h3 {
                margin: 0 0 15px 0;
                color: #2c3e50;
                font-size: 1.3em;
            }
            .tournament-highlight {
                background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
                color: white;
                padding: 20px;
                border-radius: 8px;
                text-align: center;
                margin: 20px 0;
                font-weight: 600;
                font-size: 1.1em;
                letter-spacing: 0.5px;
            }
            .contact-info {
                background: #e8f5e8;
                padding: 20px;
                border-radius: 8px;
                margin: 20px 0;
                border-left: 4px solid #27ae60;
            }
            .admin-section {
                background: #fff3cd;
                border: 1px solid #ffeaa7;
                border-radius: 8px;
            }
            .form-group {
                margin-bottom: 15px;
            }
            .form-group label {
                display: block;
                margin-bottom: 5px;
                font-weight: 600;
                color: #2c3e50;
            }
            .form-group input, .form-group select {
                width: 100%;
                padding: 8px 12px;
                border: 1px solid #dee2e6;
                border-radius: 4px;
                font-size: 1em;
            }
            .form-group input:focus, .form-group select:focus {
                outline: none;
                border-color: #3498db;
                box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            }
            .btn {
                background: #3498db;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 1em;
                font-weight: 600;
                transition: background 0.3s ease;
            }
            .btn:hover {
                background: #2980b9;
            }
            .btn-danger {
                background: #dc3545;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 0.9em;
            }
            .btn-danger:hover {
                background: #c82333;
            }
            .form-row {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            .admin-tabs {
                background: #fff3cd;
            }
            .data-table {
                width: 100%;
                margin-top: 20px;
            }
            .data-table th, .data-table td {
                padding: 10px;
                text-align: left;
                border-bottom: 1px solid #dee2e6;
            }
            .data-table th {
                background: #f8f9fa;
                font-weight: 600;
            }
            @media (max-width: 768px) {
                body {
                    padding: 10px;
                }
                .header {
                    padding: 20px;
                }
                .header h1 {
                    font-size: 2em;
                }
                .section {
                    padding: 15px;
                }
                table {
                    font-size: 0.9em;
                }
                th,
                td {
                    padding: 8px 10px;
                }
                .points-system {
                    grid-template-columns: repeat(2, 1fr);
                }
            }
            @media print {
                body {
                    background: white;
                }
                .section {
                    box-shadow: none;
                    border: 1px solid #ccc;
                }
                table {
                    box-shadow: none;
                }
            }
        </style>
    </head>
    <body>
        <div
            style="
                font-family:
                    &quot;Segoe UI&quot;, Tahoma, Geneva, Verdana, sans-serif;
                max-width: 1000px;
                margin: 0 auto;
                padding: 20px;
                line-height: 1.6;
                color: #333;
            "
        >
            <header
                style="
                    text-align: center;
                    margin-bottom: 40px;
                    padding: 30px;
                    background: linear-gradient(
                        135deg,
                        #f8f9fa 0%,
                        #e9ecef 100%
                    );
                    border-radius: 12px;
                    border: 1px solid #dee2e6;
                "
            >
                <h1
                    style="
                        margin: 0 0 10px 0;
                        font-size: 2.5em;
                        color: #2c3e50;
                        font-weight: 700;
                    "
                >
                    Buggy Lapping Tournament
                </h1>
                <p style="margin: 0; font-size: 1.1em; color: #6c757d">
                    Tournament Starts: October 18, 2025
                </p>
            </header>



            <div class="tab-navigation">
                <button
                    class="tab-button active"
                    onclick="showTab('tournament-info')"
                >
                    Tournament Info
                </button>
                <button class="tab-button" onclick="showTab('rules')">
                    Rules
                </button>
                <button class="tab-button" onclick="showTab('standings')">
                    Standings
                </button>
                <button class="tab-button" onclick="showTab('points')">
                    Points System
                </button>
                <button class="tab-button" onclick="showTab('zones-view')">
                    Zones/Maps
                </button>
            </div>
            <div
                class="tab-navigation admin-tabs"
                id="admin-tabs"
                style="
                    display: none;
                    border-top: 1px solid #dee2e6;
                    margin-top: -1px;
                "
            >
                <button class="tab-button" onclick="showTab('zones')">
                    Zone Management
                </button>
                <button class="tab-button" onclick="showTab('racers')">
                    Racer Management
                </button>
                <button class="tab-button" onclick="showTab('lap-times')">
                    Record Lap Times
                </button>
            </div>

            <!-- Tournament Info Tab -->
            <div id="tournament-info" class="tab-content active">
                <section class="section tab-section">
                    <div class="tournament-highlight">
                        THE ULTIMATE BUGGY LAPPING TOURNAMENT<br />
                        EIGHT WEEKS. EIGHT ZONES. ONE CHAMPION.
                    </div>

                    <p
                        style="
                            font-size: 1.1em;
                            text-align: center;
                            margin-bottom: 30px;
                            color: #2c3e50;
                        "
                    >
                        Think you have the skill and consistency to dominate the
                        track? This is your chance to prove it. Compete in the
                        season's most demanding racing series and fight for the
                        championship title.
                    </p>

                    <div class="tournament-info">
                        <h3>EVENT OVERVIEW</h3>
                        <p>
                            <strong>WHAT:</strong> An 8-week, point-based
                            lapping championship.
                        </p>
                        <p>
                            <strong>WHEN:</strong> 8 Consecutive Saturdays,
                            starting 10/18/2025 and ends December 6, 2025.
                        </p>
                        <p>
                            <strong>FORMAT:</strong> Each weekly event is 4
                            hours long. You get up to 3 attempts to set your
                            fastest lap time!
                        </p>
                    </div>

                    <div class="tournament-info">
                        <h3>HOW TO WIN</h3>
                        <p>
                            <strong>EARN POINTS:</strong> Get on the leaderboard
                            each week to score points.
                        </p>
                        <p>
                            <strong>BE CONSISTENT:</strong> The racer with the
                            most total points after 8 weeks is the Grand
                            Champion!
                        </p>
                        <p>
                            <strong>WIN BIG:</strong> Awesome prizes for the top
                            8 overall finishers, plus participation swag for
                            everyone who competes!
                        </p>
                    </div>

                    <div class="tournament-highlight">
                        Everyone is encouraged to compete! This is for fun and
                        engagement! See you There!
                    </div>

                    <div class="contact-info">
                        <h3>Questions?</h3>
                        <p>
                            Any questions, please direct them to me:
                            <strong>Jen_007</strong>. If not online, please send
                            a message and I will respond asap. Thank you!
                        </p>
                    </div>
                </section>
            </div>

            <!-- Rules Tab -->
            <div id="rules" class="tab-content">
                <section class="section tab-section rules-section">
                    <h2>Tournament Rules</h2>
                    <div class="rules-text">
                        <strong style="font-size: 1.1em"
                            >Tournament Rules &amp; Code of Conduct</strong
                        ><br />
                        • Be Kind &amp; Courteous: Treat participants and staff
                        with respect. Be aware of fellow lappers.<br />
                        • Zone Rules: No yelling, griefing, or arguing with
                        event staff/participants.<br />
                        • Zero-Tolerance: Violations result in immediate
                        disqualification and tournament ban.<br /><br />
                        <strong style="font-size: 1.1em"
                            >On-Track &amp; Racing Rules</strong
                        ><br />
                        • Starting Gate: Wait 10+ seconds for lapper ahead
                        before starting to avoid bumping.<br />
                        • Track Exit: After flipping, head to nearest zone line
                        to exit safely.<br />
                        • Technical Difficulties: If disconnected, rejoin and
                        retry once resolved.
                    </div>
                </section>
            </div>

            <!-- Standings Tab -->
            <div id="standings" class="tab-content">
                <section class="section tab-section">
                    <h2>Tournament Standings</h2>
                    <div id="standings-list">
                        <table class="standings-table">
                            <thead>
                                <tr>
                                    <th>Pos</th>
                                    <th>Player</th>
                                    <th>Total Points</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td
                                        colspan="3"
                                        style="
                                            text-align: center;
                                            color: #6c757d;
                                            font-style: italic;
                                        "
                                    >
                                        No players or results recorded
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>

            <!-- Points System Tab -->
            <div id="points" class="tab-content">
                <section class="section tab-section">
                    <h2>Points System Reference</h2>
                    <div class="points-system">
                        <div class="points-badge gold">1st: 10 pts</div>
                        <div class="points-badge silver">2nd: 9 pts</div>
                        <div class="points-badge bronze">3rd: 8 pts</div>
                        <div class="points-badge">4th: 7 pts</div>
                        <div class="points-badge">5th: 6 pts</div>
                        <div class="points-badge">6th: 5 pts</div>
                        <div class="points-badge">7th: 4 pts</div>
                        <div class="points-badge">8th: 3 pts</div>
                        <div class="points-badge">9th+: 1 pt</div>
                    </div>
                </section>
            </div>

            <!-- Zones/Maps Tab -->
            <div id="zones-view" class="tab-content">
                <section class="section tab-section">
                    <h2>Tournament Zones/Maps</h2>
                    <div id="zones-view-list">
                        <div class="zones-grid">
                            <!-- Zones will be dynamically populated here -->
                        </div>
                    </div>
                </section>
            </div>

            <!-- Zone Management Tab -->
            <div id="zones" class="tab-content admin-section">
                <section class="section tab-section">
                    <h2>Zone/Map Management</h2>
                    <form
                        onsubmit="TournamentData.addZone(document.getElementById('zone-name').value, document.getElementById('map-name').value); this.reset(); return false;"
                    >
                        <div class="form-row">
                            <div class="form-group">
                                <label for="zone-name">Zone Name:</label>
                                <input
                                    type="text"
                                    id="zone-name"
                                    required=""
                                    placeholder="e.g., Zone 1"
                                />
                            </div>
                            <div class="form-group">
                                <label for="map-name">Map Name:</label>
                                <input
                                    type="text"
                                    id="map-name"
                                    required=""
                                    placeholder="e.g., Alpine Circuit"
                                />
                            </div>
                        </div>
                        <button type="submit" class="btn">Add Zone</button>
                    </form>

                    <h3 style="margin-top: 30px">Current Zones</h3>
                    <div id="zones-list"></div>
                </section>
            </div>

            <!-- Racer Management Tab -->
            <div id="racers" class="tab-content admin-section">
                <section class="section tab-section">
                    <h2>Racer Management</h2>
                    <form
                        onsubmit="TournamentData.addRacer(document.getElementById('racer-name').value); this.reset(); return false;"
                    >
                        <div class="form-group">
                            <label for="racer-name">Racer Name:</label>
                            <input
                                type="text"
                                id="racer-name"
                                required=""
                                placeholder="Enter racer name"
                            />
                        </div>
                        <button type="submit" class="btn">Add Racer</button>
                    </form>

                    <h3 style="margin-top: 30px">Registered Racers</h3>
                    <div id="racers-list"></div>
                </section>
            </div>

            <!-- Lap Times Tab -->
            <div id="lap-times" class="tab-content admin-section">
                <section class="section tab-section">
                    <h2>Record Lap Times</h2>
                    <form
                        onsubmit="TournamentData.addLapTime(document.getElementById('racer-select').value, document.getElementById('zone-select').value, document.getElementById('lap-time').value); this.reset(); return false;"
                    >
                        <div class="form-group">
                            <label for="racer-select">Racer:</label>
                            <select id="racer-select" required="">
                                <option value="">Select Racer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="zone-select">Zone:</label>
                            <select id="zone-select" required="">
                                <option value="">Select Zone</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="lap-time">Lap Time:</label>
                                <input
                                    type="text"
                                    id="lap-time"
                                    required=""
                                    placeholder="MM:SS.mmm"
                                    pattern="[0-9]{1,2}:[0-5][0-9]\.[0-9]{3}"
                                />
                            </div>
                        </div>
                        <button type="submit" class="btn">
                            Record Lap Time
                        </button>
                    </form>
                    <p
                        style="
                            margin-top: 20px;
                            font-size: 0.9em;
                            color: #6c757d;
                        "
                    >
                        <strong>Note:</strong> Enter lap times in MM:SS.mmm
                        format (e.g., 1:23.456)
                    </p>
                </section>
            </div>

            <footer
                style="
                    margin-top: 40px;
                    padding: 20px;
                    text-align: center;
                    background: #f8f9fa;
                    border-radius: 8px;
                    border: 1px solid #dee2e6;
                "
            >
                <p style="margin: 0; font-size: 0.9em; color: #6c757d">
                    Tournament starts on October 18, 2025<br />
                    <strong>8-Zone Lapping Tournament Manager</strong>
                </p>
            </footer>
        </div>

        <script>
            // Tournament data storage system
            class TournamentManager {
                constructor() {
                    this.players = [];
                    this.zones = [];
                    this.isAdmin = this.isLocalhost();
                    this.loadTournamentData();
                }

                isLocalhost() {
                    return (
                        window.location.hostname === "localhost" ||
                        window.location.hostname === "127.0.0.1" ||
                        window.location.hostname === ""
                    );
                }



                // Load tournament data from JSON files (for Netlify compatibility)
                async loadTournamentData() {
                    try {
                        // Try to load players data
                        const playersResponse =
                            await fetch("data/players.json");
                        if (playersResponse.ok) {
                            this.players = await playersResponse.json();
                        }

                        // Try to load zones data
                        const zonesResponse = await fetch("data/zones.json");
                        if (zonesResponse.ok) {
                            this.zones = await zonesResponse.json();
                        }

                        this.initializeAdmin();
                        this.displayStandings();
                    } catch (error) {
                        console.log(
                            "No tournament data files found, using default state",
                        );
                        this.initializeAdmin();
                        this.displayStandings();
                    }
                }

                initializeAdmin() {
                    if (this.isAdmin) {
                        this.showAdminFeatures();
                        this.updateDropdowns();
                    }
                }

                showAdminFeatures() {
                    const adminTabs = document.getElementById("admin-tabs");
                    if (adminTabs) {
                        adminTabs.style.display = "flex";
                    }
                }

                // Calculate total points for each player
                calculatePlayerStats() {
                    const playerStats = {};

                    // Initialize all players
                    this.players.forEach((player) => {
                        playerStats[player.name] = {
                            name: player.name,
                            totalPoints: 0,
                            zoneResults: {},
                        };
                    });

                    // Calculate points from each zone
                    this.zones.forEach((zone) => {
                        if (zone.results) {
                            zone.results.forEach((result, index) => {
                                if (playerStats[result]) {
                                    const points = this.getPointsForPosition(
                                        index + 1,
                                    );
                                    playerStats[result].totalPoints += points;
                                    playerStats[result].zoneResults[zone.name] =
                                        {
                                            position: index + 1,
                                            points: points,
                                        };
                                }
                            });
                        }
                    });

                    return Object.values(playerStats).sort(
                        (a, b) => b.totalPoints - a.totalPoints,
                    );
                }

                // Get points based on finishing position
                getPointsForPosition(position) {
                    const pointsMap = {
                        1: 10,
                        2: 9,
                        3: 8,
                        4: 7,
                        5: 6,
                        6: 5,
                        7: 4,
                        8: 3,
                    };
                    return pointsMap[position] || 1;
                }

                // Display the tournament standings
                displayStandings() {
                    const standingsList =
                        document.getElementById("standings-list");
                    if (!standingsList) return;

                    const playerStats = this.calculatePlayerStats();

                    if (playerStats.length === 0) {
                        standingsList.innerHTML = `
                            <table class="standings-table">
                                <thead>
                                    <tr>
                                        <th>Pos</th>
                                        <th>Player</th>
                                        <th>Total Points</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="3" style="text-align: center; color: #6c757d; font-style: italic;">
                                            No players or results recorded
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        `;
                        return;
                    }

                    let html = `
                        <table class="standings-table">
                            <thead>
                                <tr>
                                    <th>Pos</th>
                                    <th>Player</th>
                                    <th>Total Points</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;

                    playerStats.forEach((player, index) => {
                        const positionClass =
                            index < 3 ? `position-${index + 1}` : "";
                        const leaderClass = index === 0 ? "leader-row" : "";
                        html += `
                            <tr class="${leaderClass}">
                                <td class="${positionClass}">${index + 1}</td>
                                <td>${player.name}</td>
                                <td class="total-points">${player.totalPoints}</td>
                            </tr>
                        `;
                    });

                    html += "</tbody></table>";

                    // Add zone-by-zone breakdown
                    this.zones.forEach((zone) => {
                        html += `
                            <div class="zone-table">
                                <h3>${zone.name}</h3>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Pos</th>
                                            <th>Player</th>
                                            <th>Points</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;

                        if (zone.results) {
                            zone.results.forEach((playerName, index) => {
                                const positionClass =
                                    index < 3 ? `position-${index + 1}` : "";
                                const points = this.getPointsForPosition(
                                    index + 1,
                                );
                                html += `
                                    <tr>
                                        <td class="${positionClass}">${index + 1}</td>
                                        <td>${playerName}</td>
                                        <td>${points}</td>
                                    </tr>
                                `;
                            });
                        }

                        html += "</tbody></table></div>";
                    });

                    standingsList.innerHTML = html;
                }

                updateDropdowns() {
                    const racerSelect = document.getElementById("racer-select");
                    const zoneSelect = document.getElementById("zone-select");

                    if (racerSelect) {
                        racerSelect.innerHTML =
                            '<option value="">Select Racer</option>';
                        this.players.forEach((player) => {
                            racerSelect.innerHTML += `<option value="${player.name}">${player.name}</option>`;
                        });
                    }

                    if (zoneSelect) {
                        zoneSelect.innerHTML =
                            '<option value="">Select Zone</option>';
                        this.zones.forEach((zone) => {
                            zoneSelect.innerHTML += `<option value="${zone.name}">${zone.name}</option>`;
                        });
                    }
                }
            }

            // Admin functionality (only available on localhost)
            const TournamentData = {
                isLocalhost: () => {
                    return (
                        window.location.hostname === "localhost" ||
                        window.location.hostname === "127.0.0.1" ||
                        window.location.hostname === ""
                    );
                },

                init: function () {
                    if (this.isLocalhost()) {
                        this.renderZones();
                        this.renderRacers();
                    }
                },

                addZone: function (name, mapName) {
                    const zone = {
                        id: Date.now(),
                        name: name,
                        map: mapName,
                        results: [],
                    };

                    // Update zones.json file
                    this.updateZonesFile(zone);
                    this.renderZones();
                    this.renderPublicZones();
                },

                deleteZone: function (id) {
                    console.log("Delete zone:", id);
                    alert(
                        "Zone deleted. You'll need to manually update the data/zones.json file.",
                    );
                    this.renderZones();
                },

                addRacer: function (name) {
                    const racer = {
                        id: Date.now(),
                        name: name,
                        points: 0,
                        races: 0,
                    };

                    console.log("Racer added:", racer);
                    alert(
                        `Racer "${name}" has been added. You'll need to manually update the data/players.json file.`,
                    );
                    this.renderRacers();
                },

                deleteRacer: function (id) {
                    console.log("Delete racer:", id);
                    alert(
                        "Racer deleted. You'll need to manually update the data/players.json file.",
                    );
                    this.renderRacers();
                },

                addLapTime: function (racer, zone, lapTime) {
                    console.log("Lap time recorded:", { racer, zone, lapTime });
                    alert(
                        `Lap time ${lapTime} recorded for ${racer} in ${zone}. You'll need to manually update the data files.`,
                    );
                },

                updateZonesFile: function(newZone) {
                    // Get current zones
                    const currentZones = window.tournamentManager.zones || [];
                    currentZones.push(newZone);

                    // Update local zones array immediately
                    window.tournamentManager.zones = currentZones;

                    // Create the updated JSON content
                    const updatedContent = JSON.stringify(currentZones, null, 2);

                    // For now, we'll update the local data and show instructions for manual commit
                    console.log('Updated zones.json content:', updatedContent);

                    // Show instructions for manual GitHub update
                    this.showUpdateInstructions(updatedContent);
                },

                deleteZoneFromFile: function(id) {
                    const currentZones = window.tournamentManager.zones || [];
                    const updatedZones = currentZones.filter(zone => zone.id !== id);

                    // Update local zones array immediately
                    window.tournamentManager.zones = updatedZones;

                    // Create the updated JSON content
                    const updatedContent = JSON.stringify(updatedZones, null, 2);

                    console.log('Updated zones.json content:', updatedContent);

                    // Show instructions for manual GitHub update
                    this.showUpdateInstructions(updatedContent, 'delete');

                    // Re-render the zones
                    this.renderZones();
                    this.renderPublicZones();
                },

                showUpdateInstructions: function(jsonContent, action = 'add') {
                    const actionText = action === 'delete' ? 'deleted' : 'added';
                    const message = `
Zone ${actionText} successfully!

To make this change permanent and visible to all visitors:

1. Copy the JSON content below
2. Open the zones.json file in your GitHub repository
3. Replace the entire content with the new JSON
4. Commit and push the changes

JSON Content:
${jsonContent}

After pushing, Netlify will automatically rebuild the site with the updated zones.
                    `;

                    // Create a modal or alert with the instructions
                    const modal = document.createElement('div');
                    modal.style.cssText = `
                        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                        background: rgba(0,0,0,0.5); display: flex; align-items: center;
                        justify-content: center; z-index: 10000;
                    `;

                    modal.innerHTML = `
                        <div style="background: white; padding: 20px; border-radius: 8px; max-width: 600px; max-height: 80vh; overflow-y: auto;">
                            <h3>Zone ${actionText} - Update Required</h3>
                            <p>${message.replace(/\n/g, '<br>')}</p>
                            <textarea style="width: 100%; height: 200px; font-family: monospace; margin: 10px 0;">${jsonContent}</textarea>
                            <button onclick="this.parentElement.parentElement.remove()" style="background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">Close</button>
                        </div>
                    `;

                    document.body.appendChild(modal);
                },

                renderZones: function () {
                    const zonesList = document.getElementById("zones-list");
                    if (!zonesList) return;

                    // Get zones from TournamentManager
                    const tournamentManager = window.tournamentManager;
                    if (!tournamentManager || !tournamentManager.zones) {
                        zonesList.innerHTML = '<p>Loading zones...</p>';
                        return;
                    }

                    if (tournamentManager.zones.length === 0) {
                        zonesList.innerHTML = '<p>No zones have been added yet.</p>';
                        return;
                    }

                    let html = '<div class="zones-grid">';
                    tournamentManager.zones.forEach(zone => {
                        html += `
                            <div class="zone-card" style="position: relative;">
                                <h3>${zone.name}</h3>
                                <p>${zone.map || 'No map specified'}</p>
                                <p style="font-size: 0.9em; margin-top: 10px;">
                                    ${zone.results ? zone.results.length : 0} participants
                                </p>
                                <button onclick="TournamentData.deleteZone(${zone.id})"
                                        style="position: absolute; top: 10px; right: 10px;
                                               background: #e74c3c; color: white; border: none;
                                               border-radius: 4px; padding: 5px 10px;
                                               cursor: pointer; font-size: 12px;">
                                    Delete
                                </button>
                            </div>
                        `;
                    });
                    html += '</div>';
                    zonesList.innerHTML = html;
                },

                renderPublicZones: function () {
                    const zonesList = document.getElementById("zones-view-list");
                    if (!zonesList) return;

                    // Get zones from TournamentManager
                    const tournamentManager = window.tournamentManager;
                    if (!tournamentManager || !tournamentManager.zones) {
                        zonesList.innerHTML = '<p>Loading zones...</p>';
                        return;
                    }

                    if (tournamentManager.zones.length === 0) {
                        zonesList.innerHTML = '<p>No zones have been added yet.</p>';
                        return;
                    }

                    let html = '<div class="zones-grid">';
                    tournamentManager.zones.forEach(zone => {
                        html += `
                            <div class="zone-card">
                                <h3>${zone.name}</h3>
                                <p>${zone.map || 'No map specified'}</p>
                                <p style="font-size: 0.9em; margin-top: 10px;">
                                    ${zone.results ? zone.results.length : 0} participants
                                </p>
                            </div>
                        `;
                    });
                    html += '</div>';
                    zonesList.innerHTML = html;
                },

                deleteZone: function(id) {
                    if (confirm('Are you sure you want to delete this zone?')) {
                        this.deleteZoneFromFile(id);
                    }
                },

                renderRacers: function () {
                    const racersList = document.getElementById("racers-list");
                    if (!racersList) return;

                    // For now, show a message about manual JSON editing
                    racersList.innerHTML = `
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #3498db;">
                            <p><strong>Note:</strong> Racer management requires manually editing the data/players.json file.</p>
                            <p>Add players to the JSON array with this format:</p>
                            <pre style="background: #e9ecef; padding: 10px; border-radius: 4px; overflow-x: auto;">
{
  "name": "Player Name",
  "zone": "Zone Assignment"
}</pre>
                        </div>
                    `;
                },
            };

            // Tab switching function
            function showTab(tabName) {
                // Hide all tabs
                const tabs = document.querySelectorAll(".tab-content");
                tabs.forEach((tab) => tab.classList.remove("active"));

                // Remove active class from all buttons
                const buttons = document.querySelectorAll(".tab-button");
                buttons.forEach((button) => button.classList.remove("active"));

                // Show selected tab
                const selectedTab = document.getElementById(tabName);
                if (selectedTab) {
                    selectedTab.classList.add("active");
                }

                // Add active class to clicked button
                event.target.classList.add("active");
            }

            // Initialize tournament manager when page loads
            document.addEventListener("DOMContentLoaded", () => {
                const tournamentManager = new TournamentManager();
                window.tournamentManager = tournamentManager; // Make it globally available
                TournamentData.init();

                // Also render public zones view
                TournamentData.renderPublicZones();
            });
        </script>
    </body>
</html>
